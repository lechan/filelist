<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head> 
<title>级联菜单</title> 
<meta http-equiv="Content-Type" content="text/html; charset=gb2312"> 
</head> 
<body> 
<select id="s1"></select> 
<select id="s2"></select> 
<select id="s3"></select> 
<script type="text/javascript">

function Dsy(){ 
	this.Items = {}; 
} 
Dsy.prototype.add = function(id,iArray){ 
	this.Items[id] = iArray; 
} 
Dsy.prototype.Exists = function(id){ 
	if(typeof(this.Items[id]) == "undefined"){ 
		return false; 
	} 
	return true; 
} 

function change(v){ 
	var str="0"; 
	for(i=0;i<v;i++){ 
		str+=("_"+(document.getElementById(s[i]).selectedIndex-1)); 
	}; 
	var ss=document.getElementById(s[v]); 
	with(ss){ 
		length = 0; 
		options[0]=new Option(opt0[v],opt0[v]); 
		if(v && document.getElementById(s[v-1]).selectedIndex>0 || !v){ 
			if(dsy.Exists(str)){ 
				ar = dsy.Items[str]; 
				for(i=0;i<ar.length;i++){ 
					options[length]=new Option(ar[i],ar[i]); 
				} 
				if(v) options[0].selected = true; 
			} 
		} 
		if(++v<s.length){ 
			change(v); 
		} 
	} 
} 

var dsy = new Dsy(); 

dsy.add("0",["安全驾驶培训-1级“高级驾驶”(1天课程）","赛道驾驶培训-2级“M 强化训练”（2天课程）","赛道驾驶培训-3级“完美掌控”（2天课程）","漂移大师培训 （1天课程）","方程式驾驶培训-“强化训练”（2天课程）","越野驾驶体验之旅-xDrive 驾驶体验 （6天体验）"]); 
dsy.add("0_0",["北京金港汽车公园","上海F1国际赛车场"]); 
dsy.add("0_0_0",["2013年9月13日","2013年9月14日","2013年9月15日"]); 
dsy.add("0_0_1",["2013年11月15日","2013年11月17日","2013年11月19日","2013年11月21日"]); 
dsy.add("0_1",["北京金港汽车公园","上海F1国际赛车场"]); 
dsy.add("0_1_0",["2013年9月19日-20日","2013年9月21日-22日"]); 
dsy.add("0_1_1",["2013年11月14日-15日","2013年11月16日-17日"]); 
dsy.add("0_2",["上海F1国际赛车场"]); 
dsy.add("0_2_0",["2013年11月18日-19日","2013年11月20日-21日"]); 
dsy.add("0_3",["北京金港汽车公园","上海F1国际赛车场"]); 
dsy.add("0_3_0",["2013年9月19日","2013年9月21日"]); 
dsy.add("0_3_1",["2013年11月27日","2013年11月28日"]); 
dsy.add("0_4",["上海F1国际赛车场"]); 
dsy.add("0_4_0",["2013年11月25日-26日","2013年11月27日-28日"]); 
dsy.add("0_5",["丽江"]); 
dsy.add("0_5_0",["2013年10月14日-20日","2013年10月21日-27日"]); 

var s=["s1","s2","s3"]; 
var opt0 = ["请选择","请选择","请选择"]; 
function setup(){ 
	for(i=0;i<s.length-1;i++){ 
		document.getElementById(s[i]).onchange=new Function("change("+(i+1)+")"); 
	}
	change(0);
} 

setup();
</script> 
</body> 
</html> 