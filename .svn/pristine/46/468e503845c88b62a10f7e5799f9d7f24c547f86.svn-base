(function(WIN, E){
	var U=LENOVO.util;

	var App={
		url:'/video/api/channels?code=10001'
		//url:'MOCK/channel.json'

		,doms:{slider:'#slider', ctn:'#chnlCtn'}
		,sliderTmpl:null, ctnTmpl:null
		,init:function(){
			var doms=this.doms;
			U.initDoms(doms);
			this.sliderTmpl=$(doms.slider.children()[0]).remove().removeClass(E.clsTpl);
			this.ctnTmpl=$(doms.ctn.children()[0]).remove().removeClass(E.clsTpl);
			//this.sliderTmpl=this.sliderTmpl[0].outerHTML;
			//this.ctnTmpl=this.ctnTmpl[0].outerHTML;
			this.load();
		}
		,load:function(){
			var t=this;
			$.getJSON(this.url, null, t.doms.ctn, function(d){t.render(d);});
		}
		,render:function(d){
			var doms=this.doms;
			if(d.ads&&d.ads.length){
				var ads=d.ads;
				var c=document.createDocumentFragment();
				for(var i=0, len=ads.length; i<len; i++){
					var it=this.sliderTmpl.clone();
					it.attr('href', ads[i].targetUrl);
					it.attr('data-pgn', ads[i].name);
					it.attr('data-pos', i);
					$(it.children()[0]).attr('src', ads[i].bannerPath);
					c.appendChild(it[0]);
				}
				doms.slider.append(c);
				U.Slider.init();
			}else{
				doms.slider.parent().hide();
			}
			if(d.channels&&d.channels.length){
				var chnls=d.channels;
				var c=document.createDocumentFragment();
				for(var i=0, len=chnls.length; i<len; i++){
					var it=this.ctnTmpl.clone();
					it.attr('href', it.attr('href')+chnls[i].code+'&name='+encodeURIComponent(chnls[i].name));
					it.find('img').attr('src', chnls[i].iconPath);
					it.find('.chnl-tit-txt').html(chnls[i].name);
					it.find('.chnl-tit-num').html(chnls[i].albumCount);
					it.find('.chnl-synopsis').html(chnls[i].shortDesc);
					c.appendChild(it[0]);
				}
				doms.ctn.append(c);
			}else{
				doms.ctn.addClass(E.clsEmpty);
			}
		}
	};

	$(function(){
		App.init();
	});
})(window, LENOVO.enum);
