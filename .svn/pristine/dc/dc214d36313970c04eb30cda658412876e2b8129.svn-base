//     (c) 2010-2014 Thomas Fuchs

//     Zepto.js may be freely distributed under the MIT license.

(function(a){function b(a,b,c,d){return Math.abs(a-b)>=Math.abs(c-d)?a-b>0?"Left":"Right":c-d>0?"Up":"Down"}function c(){l=null,h.last&&(h.el.trigger("longTap"),h={})}function d(){l&&clearTimeout(l),l=null}function e(){i&&clearTimeout(i),j&&clearTimeout(j),k&&clearTimeout(k),l&&clearTimeout(l),i=j=k=l=null,h={}}function f(a){return(a.pointerType=="touch"||a.pointerType==a.MSPOINTER_TYPE_TOUCH)&&a.isPrimary}function g(a,b){return a.type=="pointer"+b||a.type.toLowerCase()=="mspointer"+b}var h={},i,j,k,l,m=750,n;a(document).ready(function(){var o,p,q=0,r=0,s,t;"MSGesture"in window&&(n=new MSGesture,n.target=document.body),a(document).bind("MSGestureEnd",function(a){var b=a.velocityX>1?"Right":a.velocityX<-1?"Left":a.velocityY>1?"Down":a.velocityY<-1?"Up":null;b&&(h.el.trigger("swipe"),h.el.trigger("swipe"+b))}).on("touchstart MSPointerDown pointerdown",function(b){if((t=g(b,"down"))&&!f(b))return;s=t?b:b.touches[0],b.touches&&b.touches.length===1&&h.x2&&(h.x2=undefined,h.y2=undefined),o=Date.now(),p=o-(h.last||o),h.el=a("tagName"in s.target?s.target:s.target.parentNode),i&&clearTimeout(i),h.x1=s.pageX,h.y1=s.pageY,p>0&&p<=250&&(h.isDoubleTap=!0),h.last=o,l=setTimeout(c,m),n&&t&&n.addPointer(b.pointerId)}).on("touchmove MSPointerMove pointermove",function(a){if((t=g(a,"move"))&&!f(a))return;s=t?a:a.touches[0],d(),h.x2=s.pageX,h.y2=s.pageY,q+=Math.abs(h.x1-h.x2),r+=Math.abs(h.y1-h.y2);var b=!1;navigator.userAgent.match(/Android/i)&&(b=!0),b&&q>10&&q>r&&a.preventDefault()}).on("touchend MSPointerUp pointerup",function(c){if((t=g(c,"up"))&&!f(c))return;d(),h.x2&&Math.abs(h.x1-h.x2)>30||h.y2&&Math.abs(h.y1-h.y2)>30?k=setTimeout(function(){h.el.trigger("swipe"),h.el.trigger("swipe"+b(h.x1,h.x2,h.y1,h.y2)),h={}},0):"last"in h&&(q<30&&r<30?j=setTimeout(function(){var b=a.Event("tap");b.cancelTouch=e,h.el.trigger(b),h.isDoubleTap?(h.el&&h.el.trigger("doubleTap"),h={}):i=setTimeout(function(){i=null,h.el&&h.el.trigger("singleTap"),h={}},250)},0):h={}),q=r=0}).on("touchcancel MSPointerCancel pointercancel",e),a(window).on("scroll",e)}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(b){a.fn[b]=function(a){return this.on(b,a)}})})(Zepto)