<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=0.6, maximum-scale=0.6, user-scalable=0" />
<title>无标题文档</title>
</head>

<body>
<style type="text/css">
html, body{height: 100%;overflow: hidden;background: black;-webkit-user-select: none;}
ul {list-style-type:none;padding: 0;margin-left: 12px;}
ul >li {width: 40px;height: 40px;border-radius:50%;opacity: 0.3;display: inline-block;}
ul.red >#red, ul.green >#green,ul.yellow >#yellow{opacity: 1.0;}
#red {background: red;}
#yellow {background: yellow;}
#green {background: green;}
</style>
<ul id="traffic" class="green">
  <li id="green"></li>
  <li id="yellow"></li>
  <li id="red"></li>
</ul>
<script type="text/javascript">
Promise.prototype.turn = function(color){
    return this.then(function(){ traffic.className = color; });
}

Promise.prototype.wait = function(d){
    return this.then(function(){ 
        return new Promise(function(resolve, reject) {
            setTimeout(resolve,d);
        })
    });
}
void function(){
    Promise.resolve()
    .turn('green')
    .wait(5000)
    .turn('yellow')
    .wait(2000)
    .turn('red')
    .wait(5000)
    .then(arguments.callee);
}();
</script>
</body>
</html>
