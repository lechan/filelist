define(['tool','zepto','swipe','iscroll'], function(tool) {
	"use strict";
	var App = {
		config : {
			url : 'index.json'	
		},
		tpl : {
			banner : '<div class="banner_wrap">#{bannerList}</div>',
			bannerItem : '<div><a href="#{url}"><img src="#{img}" /></a></div>'
		},
		sideBar : function(){
			$("#mainPage").on("swipeLeft",function(){
				var self = $(this);
				if(self.hasClass("swipeR")){
					$(this).removeClass("swipeR");
					tool.scrollStatus.status = true;
				}else{
					$(this).addClass("swipeL");
					tool.scrollStatus.status = false;
				}
			}).on("swipeRight",function(){
				var self = $(this);
				if(self.hasClass("swipeL")){
					$(this).removeClass("swipeL");
					tool.scrollStatus.status = true;
				}else{
					$(this).addClass("swipeR");
					tool.scrollStatus.status = false;
				}
			});
			$("#mainPage").click(function(){
				alert(1);	
			});
			tool.scrollStatus.init();	
		},
		getData : function(){
			var self = this;
			$.ajax({
				url:self.config.url,
				type:"GET",
				dataType:"json",
				success: function(data){
					self.data = data;
					console.log(self.data);
					self.banner.init();
					//self.lv.init();
				},
				error: function(){
						
				}	
			});	
		},
		banner : (function(){
			var
			self = this,
			render = function(){
				var bannerData = self.data.banner;
				var bannerList = '';
				var bannerHtml = self.tpl.banner;
				$.each(bannerData,function(index){
					bannerList += t.formatTpl(self.tpl.bannerItem,{},bannerData[index]);	
				});
				alert(bannerList);
				handler();
			},
			handler = function(){
				var bannerObj = document.getElementById("banner");
				var bannerSwipe = Swipe(bannerObj, {
				  // startSlide: 4,
				  // auto: 3000,
				  // continuous: true,
				  // disableScroll: true,
				  // stopPropagation: true,
				  // callback: function(index, element) {},
				  // transitionEnd: function(index, element) {}
				});	
			},
			init = function(){
				render();
			}
			return {init:init}
		}()),
		recommendList : function(){
			var myScroll = new IScroll('#recommend_wrapper', { scrollX: true, scrollY: false, eventPassthrough: true, preventDefault: false });	
		},
		init : function(){
			this.sideBar();	
			this.recommendList();
			this.banner.init();
			tool.fastClick();
			tool.countdown.init('countdown1','2015/5/26 10:00:00',function(){
				alert(1);	
			});
			console.log(tool.formatDate('1430370000000','yyyy年MM月dd日 hh:mm:ss'));
		}
	}
		
	App.init();
		
});