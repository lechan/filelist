var cookCtrls = angular.module('cookCtrls', []);

cookCtrls.controller('startAnimeCtrl',['$scope',function($scope){
	var logo = $("#logo"),logoTxt = $("#logo h1"),searchbox = $("#search");
	setTimeout(function(){
		logo.animate({top : 150},500,function(){
			logoTxt.animate({opacity : 100},1000,function(){
				searchbox.animate({opacity : 150},500);
			});
		});
	},1000);	
}]);

cookCtrls.controller('listCtrl', ['$scope','$http',function($scope,$http,listData){
	$scope.searchBtn = function(){
		var logo = $("#logo"),flag = true;
		$scope.config = {
			_key : "5c34d0cdd72ee8145f5d4602b69d01bd",
			_menu : function(){return encodeURI($("#search_inp").val());},
			_rn : 5,
			_pn : function(){return $("#listNum").val();},
			_cb : "JSON_CALLBACK",
			url : function(){
				return "http://apis.juhe.cn/cook/query.php?key="+this._key+"&menu="+this._menu()+"&rn="+this._rn+"&pn="+this._pn()+"&callback="+this._cb;
			}
		}
		logo.hide();
		if(flag){
			flag = false;
			$http.jsonp($scope.config.url()).success(function(data){
				$scope.list = data;
				$(".wrap ul").show();
				flag = true;
			});
		}
	}
}]);